<div class="skills-inventory-container">
  <!-- Premium Header Section -->
  <div class="inventory-header premium-design">
    <div class="header-background-pattern"></div>
    <div class="header-content">
      <div class="title-wrapper">
        <div class="icon-badge">
          <mat-icon>analytics</mat-icon>
        </div>
        <div class="title-section">
          <h2>Skills Analytics Dashboard</h2>
          <p class="subtitle">Real-time analysis of skill demand, supply, and gaps</p>
        </div>
      </div>
      <div class="header-stats" *ngIf="analytics">
        <div class="stat-item last-updated">
          <mat-icon>schedule</mat-icon>
          <span class="stat-label">{{getFormattedLastUpdated()}}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="!analytics" class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Loading skills analytics...</p>
  </div>

  <!-- Main Content -->
  <div *ngIf="analytics" class="inventory-content">
    
    <!-- Featured Gap Analysis Section (Moved to Top) -->
    <div class="featured-section gap-analysis-featured">
      <div class="section-header">
        <div class="header-icon critical">
          <mat-icon>warning</mat-icon>
        </div>
        <div class="header-content">
          <h3>Critical Skill Gap Analysis</h3>
        </div>
      </div>
      
      <!-- Gap Overview Cards -->
      <div class="gap-overview-cards">
        <div class="gap-card shortage-card">
          <div class="card-icon">
            <mat-icon>trending_down</mat-icon>
          </div>
          <div class="card-content">
            <div class="card-value">{{getShortageCount()}}</div>
            <div class="card-label">Critical Shortages</div>
            <div class="card-trend negative">Immediate action needed</div>
          </div>
        </div>
        
        <div class="gap-card balanced-card">
          <div class="card-icon">
            <mat-icon>trending_flat</mat-icon>
          </div>
          <div class="card-content">
            <div class="card-value">{{getBalancedCount()}}</div>
            <div class="card-label">Balanced Skills</div>
            <div class="card-trend neutral">Stable supply</div>
          </div>
        </div>
        
        <div class="gap-card surplus-card">
          <div class="card-icon">
            <mat-icon>trending_up</mat-icon>
          </div>
          <div class="card-content">
            <div class="card-value">{{getSurplusCount()}}</div>
            <div class="card-label">Surplus Skills</div>
            <div class="card-trend positive">Available talent</div>
          </div>
        </div>
      </div>
      
      <!-- Critical Gaps List -->
      <div class="critical-gaps-list">
        <h4>Top Priority Skill Gaps</h4>
        <div class="gaps-grid">
          <div class="gap-item critical" 
               *ngFor="let gap of getCriticalGaps() | slice:0:6">
            <div class="gap-header">
              <span class="skill-name">{{gap.skill}}</span>
              <span class="gap-severity" [ngClass]="getSeverityClass(gap.gapPercentage)">
                {{gap.gapPercentage}}% gap
              </span>
            </div>
            <div class="gap-visual">
              <div class="supply-demand-bars">
                <div class="bar-item demand">
                  <span class="bar-label">Demand</span>
                  <div class="bar-container">
                    <div class="bar-fill" [style.width.%]="getRelativePercentage(gap.demand, gap.demand)"></div>
                  </div>
                  <span class="bar-value">{{gap.demand}}</span>
                </div>
                <div class="bar-item supply">
                  <span class="bar-label">Supply</span>
                  <div class="bar-container">
                    <div class="bar-fill" [style.width.%]="getRelativePercentage(gap.supply, gap.demand)"></div>
                  </div>
                  <span class="bar-value">{{gap.supply}}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Skills Demand Section -->
    <mat-card class="inventory-section demand-section">
      <mat-card-header>
        <div mat-card-avatar class="section-avatar demand-avatar">
          <mat-icon>trending_up</mat-icon>
        </div>
        <mat-card-title>Skills in Demand</mat-card-title>
        <mat-card-subtitle>Skills ranked by opportunity frequency</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="skills-list">
          <div class="skill-item" *ngFor="let demand of getDisplayedDemands(); let i = index">
            <div class="skill-rank">{{i + 1}}</div>
            <div class="skill-content">
              <div class="skill-header">
                <span class="skill-name">{{demand.skill}}</span>
                <div class="skill-metrics">
                  <span class="skill-count">{{demand.opportunityCount}} opportunities</span>
                  <span class="skill-percentage">{{demand.percentage}}%</span>
                </div>
              </div>
              <div class="skill-progress">
                <div class="progress-bar">
                  <div class="progress-fill demand-fill" 
                       [style.width.%]="getProgressWidth(demand.opportunityCount, getMaxDemand())">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="load-more-container" *ngIf="hasMore('demand')">
          <button mat-button (click)="loadMore('demand')" class="load-more-btn">
            <mat-icon>expand_more</mat-icon>
            Load More
          </button>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Skills Supply Section -->
    <mat-card class="inventory-section supply-section">
      <mat-card-header>
        <div mat-card-avatar class="section-avatar supply-avatar">
          <mat-icon>people</mat-icon>
        </div>
        <mat-card-title>Employee Skills</mat-card-title>
        <mat-card-subtitle>Skills ranked by employee count</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="skills-list">
          <div class="skill-item" *ngFor="let supply of getDisplayedSupplies(); let i = index">
            <div class="skill-rank">{{i + 1}}</div>
            <div class="skill-content">
              <div class="skill-header">
                <span class="skill-name">{{supply.skill}}</span>
                <div class="skill-metrics">
                  <span class="skill-count">{{supply.employeeCount}} employees</span>
                  <span class="skill-percentage">{{supply.percentage}}%</span>
                </div>
              </div>
              <div class="skill-progress">
                <div class="progress-bar">
                  <div class="progress-fill supply-fill" 
                       [style.width.%]="getProgressWidth(supply.employeeCount, getMaxSupply())">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="load-more-container" *ngIf="hasMore('supply')">
          <button mat-button (click)="loadMore('supply')" class="load-more-btn">
            <mat-icon>expand_more</mat-icon>
            Load More
          </button>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Skills Gap Analysis Section -->
    <mat-card class="inventory-section gaps-section">
      <mat-card-header>
        <div mat-card-avatar class="section-avatar gaps-avatar">
          <mat-icon>analytics</mat-icon>
        </div>
        <mat-card-title>Skill Gap Analysis</mat-card-title>
        <mat-card-subtitle>Supply vs demand analysis</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="gaps-summary">
          <div class="gap-summary-item shortage">
            <mat-icon>trending_down</mat-icon>
            <div class="summary-content">
              <span class="summary-count">{{getShortageCount()}}</span>
              <span class="summary-label">Skills in Shortage</span>
            </div>
          </div>
          <div class="gap-summary-item balanced">
            <mat-icon>trending_flat</mat-icon>
            <div class="summary-content">
              <span class="summary-count">{{getBalancedCount()}}</span>
              <span class="summary-label">Balanced Skills</span>
            </div>
          </div>
          <div class="gap-summary-item surplus">
            <mat-icon>trending_up</mat-icon>
            <div class="summary-content">
              <span class="summary-count">{{getSurplusCount()}}</span>
              <span class="summary-label">Skills in Surplus</span>
            </div>
          </div>
        </div>

        <div class="skills-list">
          <div class="skill-item gap-item" *ngFor="let gap of getDisplayedGaps(); let i = index">
            <div class="skill-rank">{{i + 1}}</div>
            <div class="skill-content">
              <div class="skill-header">
                <span class="skill-name">{{gap.skill}}</span>
                <div class="gap-status" [ngClass]="getGapStatusClass(gap.status)">
                  <mat-icon>{{getGapStatusIcon(gap.status)}}</mat-icon>
                  <span>{{getGapText(gap)}}</span>
                </div>
              </div>
              <div class="gap-details">
                <div class="gap-metric">
                  <span class="metric-label">Demand:</span>
                  <span class="metric-value demand-value">{{gap.demand}}</span>
                </div>
                <div class="gap-metric">
                  <span class="metric-label">Supply:</span>
                  <span class="metric-value supply-value">{{gap.supply}}</span>
                </div>
                <div class="gap-metric" *ngIf="gap.status !== 'balanced'">
                  <span class="metric-label">Gap:</span>
                  <span class="metric-value" [ngClass]="getGapStatusClass(gap.status)">
                    {{gap.gapPercentage}}%
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="load-more-container" *ngIf="hasMore('gaps')">
          <button mat-button (click)="loadMore('gaps')" class="load-more-btn">
            <mat-icon>expand_more</mat-icon>
            Load More
          </button>
        </div>
      </mat-card-content>
    </mat-card>

  </div>
</div>
